$(function(){function e(e,n,l){var o="",a=$.extend({page:1,pageSize:20,mobile:13418490922,type:r},e);$.ajax({url:api+"/notice/list",type:"POST",data:a,dataType:"json",beforeSend:function(){$(".infinite-scroll-preloader").find(".preloader").length||$(".infinite-scroll-preloader").html('<div class="preloader"></div>')},success:function(r){if("1000"==r.code){r=r.data;var a=r.items;if(a){n&&n();var s=a.length;if(!s)return $("#noData").removeClass("none"),void(l?$("#noData").html('没有找到“<span class="key">'+e.keyword+"</span>”相关数据"):$("#noData").html("暂无数据"));i=r.recordCount,m+=s;for(var c=0;s>c;c++){var d=a[c];o+='<li><a href="notice.html?'+d.type+"&"+d.id+'" class="item-link item-content external"><div class="item-inner"><div class="item-title-row">'+d.title+'</div><div class="item-subtitle item-midtitle">'+d.personName+'</div><div class="item-subtitle item-smtitle">'+d.date+("NOTICE"===d.type?"&nbsp;&nbsp;阅读("+d.clickCount+") &nbsp;&nbsp;评论("+d.commentsCount+")":"")+"</div></div></a></li>"}$(".infinite-scroll-bottom .list-container").append(o);var m=t.find("li").length;m>=i&&($.detachInfiniteScroll($(".infinite-scroll")),$(".infinite-scroll-preloader").remove(),$(".infinite-scroll-bottom .list-container").append('<li><div class="item-inner text-center item-totalnum">总共'+m+"条</div></li>"))}}else $.alert(r.msg)},error:function(){$.alert("不好意思，出错了~~")}})}var i,t=$(".list-container"),n=$("#cancel"),l=$("#searchBox"),o=!1,r=window.location.search.substring(1);e(),$(document).on("infinite",".infinite-scroll-bottom",function(){o||(o=!0,setTimeout(function(){return o=!1,last>=i?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(e({keyword:l.val()}),void $.refreshScroller())},1e3))}),n.on("click",function(){l.val("")}),l.on("keypress",function(i){13===i.charCode&&e({keyword:this.value},function(){t.empty()},!0)}),$.init()});